<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ­²æœˆæƒ…é•·</title>
    <style>
        :root {
            --ink-black: #3d3536;
            --ink-grey: #7d7273;
            --sakura-pink: #f8c6d1;
            --accent-red: #d65a77;
            --glass-bg: rgba(255, 255, 255, 0.88);
        }

        body, html {
            margin: 0; padding: 0; 
            width: 100%; height: 100%;
            font-family: 'KaiTi', 'STKaiti', 'SimSun', serif;
            background-color: #fdfcf8;
            overflow-x: hidden;
            color: var(--ink-black);
            -webkit-tap-highlight-color: transparent;
        }

        .num-font { font-family: 'Helvetica Neue', Arial, sans-serif; font-weight: 300; }

        #canvas-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; pointer-events: none;
        }

        #app {
            position: relative; z-index: 10;
            width: 100%; min-height: 100%;
            display: flex; flex-direction: column; align-items: center;
            padding: 5vh 0; /* ä½¿ç”¨è¦–çª—é«˜åº¦ç™¾åˆ†æ¯”ï¼Œè®“ä¸Šä¸‹é–“è·æ›´éˆæ´» */
            box-sizing: border-box;
        }

        /* éŸ¿æ‡‰å¼å®¹å™¨å„ªåŒ– */
        .fusion-card, .event-card {
            width: 92%; /* æ‰‹æ©Ÿç«¯ä¿æŒé©åº¦ç•™ç™½ */
            max-width: 440px; /* é›»è…¦ç«¯å¢åŠ å¯¬åº¦ï¼Œè®“ä½ˆå±€æ›´èˆ’å±• */
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 28px;
            border: 1px solid rgba(255,255,255,0.9);
            box-shadow: 0 10px 40px rgba(0,0,0,0.03);
            padding: 40px 30px; /* å¢åŠ å…§è·ï¼Œæå‡ç©ºé–“æ„Ÿ */
            text-align: center;
            box-sizing: border-box;
            transition: transform 0.25s ease;
            position: relative;
        }

        .fusion-card { margin-bottom: 20px; cursor: pointer; }
        .fusion-card:active { transform: scale(0.99); }

        .settings-trigger {
            position: absolute; top: 20px; right: 20px;
            font-size: 1.1rem; color: #e5e5e5;
            cursor: pointer; padding: 5px; z-index: 30;
            transition: color 0.3s;
        }
        .settings-trigger:hover { color: var(--ink-grey); }

        .header-symbol { font-size: 2.4rem; margin-bottom: 8px; }
        .names { font-size: 1.5rem; font-weight: bold; margin-bottom: 15px; letter-spacing: 3px; }
        .main-timer .label { font-size: 0.9rem; color: var(--ink-grey); }
        .main-timer .count { font-size: 4.8rem; color: var(--accent-red); line-height: 1; margin: 12px 0; }
        .sweet-prefix { font-size: 1rem; color: var(--accent-red); margin-top: 8px; font-weight: bold; }

        .ink-hr {
            margin: 35px auto; width: 80%; height: 1px;
            background: linear-gradient(90deg, transparent, var(--ink-grey), transparent);
            border: none; opacity: 0.2; position: relative;
        }
        .ink-hr::after {
            content: "ğŸŒ¸"; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); background: #fdfcf8;
            padding: 0 10px; font-size: 0.7rem; color: #ddd;
        }

        .quote-section { min-height: 60px; display: flex; flex-direction: column; justify-content: center; }
        .quote-text { font-size: 1.15rem; line-height: 1.6; color: var(--ink-black); margin-bottom: 10px; transition: opacity 0.3s; }
        .quote-tag { font-size: 0.75rem; color: var(--ink-grey); opacity: 0.4; }

        /* ä¸‹æ–¹ç´€å¿µæ—¥å¡ç‰‡ */
        .event-card {
            padding: 20px 30px; cursor: pointer;
            border: 1px solid rgba(255,255,255,0.5);
            max-width: 440px;
        }
        .event-header { display: flex; justify-content: space-between; align-items: center; }
        .event-title { font-size: 1.1rem; font-weight: bold; text-align: left; }
        .event-days { font-size: 1.8rem; color: var(--accent-red); }

        /* å½ˆçª—æ¨£å¼å¾®èª¿ */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.98); z-index: 2000; overflow-y: auto;
        }
        .modal-content { 
            width: 90%; max-width: 400px; margin: 50px auto; 
            background: white; padding: 30px; border-radius: 24px; 
            box-shadow: 0 15px 50px rgba(0,0,0,0.06); 
        }
        .form-group { margin-bottom: 18px; text-align: left; }
        .form-group label { font-size: 0.9rem; color: var(--ink-grey); margin-bottom: 6px; display: block; }
        .form-group input, .form-group select { 
            width: 100%; padding: 12px; border: 1px solid #f2f2f2; border-radius: 10px; 
            box-sizing: border-box; font-family: inherit; font-size: 1rem;
        }
        .switch-group { display: flex; justify-content: space-between; align-items: center; background: #fffafb; padding: 12px; border-radius: 10px; }
        .btn { width: 100%; padding: 14px; background: var(--accent-red); color: white; border: none; border-radius: 10px; font-size: 1rem; cursor: pointer; font-weight: bold; }
        .event-item { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px dotted #eee; }
    </style>
</head>
<body>

    <canvas id="canvas-bg"></canvas>

    <div id="app">
        <div class="fusion-card" onclick="handleMainCardClick()">
            <div class="settings-trigger" onclick="handleSettingsClick(event)">âš™ï¸</div>

            <div id="setup-view" style="display:none; padding: 60px 0;">
                <div class="header-symbol">ğŸŒ¸</div>
                <div style="font-size: 1.4rem; color: var(--accent-red); letter-spacing: 2px;">é»æ“Šé–‹å•Ÿæ•…äº‹</div>
                <div style="font-size: 0.9rem; color: #bbb; margin-top: 15px;">è«‹å…ˆè¨­å®šæ‚¨å€‘çš„ç´€å¿µæ—¥</div>
            </div>

            <div id="main-view">
                <div class="header-symbol" id="display-symbol">ğŸŒ¸</div>
                <div class="names" id="display-names">-- & --</div>
                <div class="main-timer">
                    <div class="label">æ”œæ‰‹å…±åº¦</div>
                    <div class="count num-font" id="days-count">0</div>
                    <div class="label">æ™å¤œ</div>
                    <div id="sweet-prefix-text" class="sweet-prefix"></div>
                </div>
                <hr class="ink-hr">
                <div class="quote-section">
                    <div class="quote-text" id="quote-text">æ˜¥é¢¨åé‡Œï¼Œä¸å¦‚é‡è¦‹ä½ ã€‚</div>
                    <div class="quote-tag" id="quote-tag">èŠ±è¦‹æ¨¡å¼ #01</div>
                </div>
            </div>
        </div>

        <div class="event-card" onclick="openEventList()" id="next-event-card" style="display:none;">
            <div class="event-header">
                <div>
                    <div class="event-title" id="next-event-name">ä¸‹å€‹ç´€å¿µæ—¥</div>
                    <div style="font-size: 0.85rem; color:#bbb; margin-top:5px;" id="next-event-date">--æœˆ--æ—¥</div>
                </div>
                <div style="text-align: right;">
                    <span class="event-days num-font" id="next-event-days">0</span>
                    <span style="font-size: 0.85rem; color: var(--ink-grey);">å¤©å¾Œ</span>
                </div>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <h3 style="text-align: center; margin: 0 0 25px 0;">å„€å¼æ„Ÿè¨­å®š</h3>
            <div class="form-group"><label>åå­— A</label><input type="text" id="input-name1"></div>
            <div class="form-group"><label>åå­— B</label><input type="text" id="input-name2"></div>
            <div class="form-group"><label>åœ¨ä¸€èµ·çš„æ—¥æœŸ</label><input type="date" id="input-start-date"></div>
            <div class="form-group">
                <label>ç›®å‰çš„æ°›åœ</label>
                <div class="switch-group">
                    <div><span id="setting-mode-icon">ğŸŒ¸</span> <span id="setting-mode-text">èŠ±è¦‹æ¨¡å¼</span></div>
                    <input type="checkbox" id="input-naughty-mode" style="width: auto;" onchange="syncModeText()">
                </div>
            </div>
            <div class="form-group">
                <label>å°ˆå±¬ç¬¦è™Ÿ</label>
                <select id="input-symbol">
                    <option value="ğŸŒ¸">ğŸŒ¸ æ«»èŠ±</option>
                    <option value="ğŸ’‹">ğŸ’‹ æ“å»</option>
                    <option value="ğŸŒ™">ğŸŒ™ æœ›æœˆ</option>
                    <option value="ğŸ®">ğŸ® çµç·£</option>
                    <option value="â¤ï¸">â¤ï¸ èµ¤èª </option>
                </select>
            </div>
            <button class="btn" onclick="saveSettings()">ä¿å­˜ä¸¦åŒæ­¥</button>
            <div style="text-align: center; margin-top: 20px; color: #ccc; cursor: pointer; font-size: 0.9rem;" onclick="closeModal('settings-modal')">å–æ¶ˆ</div>
        </div>
    </div>

    <div id="event-list-modal" class="modal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-top: 0;">ç´€å¿µæ—¥ç®¡ç†</h3>
            <div style="background: #fffafa; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                <input type="text" id="new-event-name" placeholder="äº‹ä»¶åç¨±" style="margin-bottom: 10px; width: 100%;">
                <input type="date" id="new-event-date" style="margin-bottom: 10px; width: 100%;">
                <button class="btn" style="background: var(--ink-grey);" onclick="addEvent()">æ·»åŠ </button>
            </div>
            <div id="events-container" style="max-height: 250px; overflow-y: auto;"></div>
            <div style="text-align: center; margin-top: 25px; color: #ccc; cursor: pointer;" onclick="closeModal('event-list-modal')">é—œé–‰</div>
        </div>
    </div>

    <script>
        // --- è…³æœ¬é‚è¼¯ä¿æŒä¸è®Š ---
        const quotesSweet = ["æˆ‘ä¸å¤ªæœƒè¡¨é”æ„›ï¼Œä½†æˆ‘æ¯å¤©éƒ½åœ¨æƒ³ä½ ã€‚", "ä½ ä¸€å‡ºç¾ï¼Œæˆ‘çš„ä¸–ç•Œå°±è‡ªå‹•èª¿æˆæŸ”å…‰æ¨¡å¼ã€‚", "å–œæ­¡ä½ é€™ä»¶äº‹ï¼Œæˆ‘æ‰“ç®—æ…¢æ…¢ä¾†ï¼Œä¹…ä¸€é»ã€‚", "ä½ ä¸ç”¨å¤šå¥½ï¼Œä½ æ˜¯ä½ ï¼Œå°±å·²ç¶“å¾ˆå¥½ã€‚", "æˆ‘æƒ³æŠŠä»Šå¤©éå¥½ï¼Œå› ç‚ºè£¡é¢æœ‰ä½ ã€‚", "ä½ é è¿‘çš„æ™‚å€™ï¼Œæˆ‘é€£å‘¼å¸éƒ½è®Šå¾—æº«æŸ”ã€‚", "ä¸–ç•Œå¾ˆåµï¼Œä½†ä½ ä¸€èªªè©±ï¼Œæˆ‘å°±å®‰éœäº†ã€‚", "æˆ‘æœ€å–œæ­¡çš„é¢¨æ™¯ï¼Œæ˜¯ä½ ä¸ç¶“æ„çœ‹æˆ‘çš„æ™‚å€™ã€‚", "æœ‰ä½ åœ¨çš„åœ°æ–¹ï¼Œå°±ä¸åƒåœ¨è¶•è·¯ã€‚", "æˆ‘æƒ³é™ªä½ æŠŠå¹³å‡¡çš„æ—¥å­ï¼Œéæˆå€¼å¾—å›å‘³çš„é‚£ç¨®ã€‚", "ä½ ä¸€ç¬‘ï¼Œæˆ‘å°±çŸ¥é“ä»Šå¤©æœƒæ˜¯å¥½å¤©æ°£ã€‚", "æˆ‘ä¸æ˜¯å–œæ­¡ç†±é¬§ï¼Œæˆ‘æ˜¯å–œæ­¡æœ‰ä½ ã€‚", "ä½ ä¸ç”¨å®Œç¾ï¼Œæˆ‘å–œæ­¡çš„æœ¬ä¾†å°±æ˜¯çœŸå¯¦çš„ä½ ã€‚", "å¦‚æœç”Ÿæ´»å¾ˆç´¯ï¼Œé‚£æˆ‘æŠ±ä½ ä¸€ä¸‹ã€‚", "ä½ ä¸èªªè©±çš„æ™‚å€™ï¼Œä¹Ÿå¾ˆå¥½çœ‹ã€‚", "æˆ‘æƒ³æŠŠä½ å¯«é€²è¡Œç¨‹è¡¨ï¼Œå¤©å¤©éƒ½ä¸åˆªã€‚", "æœ‰äº›æº«æŸ”ï¼Œæˆ‘åªæƒ³ç•™çµ¦ä½ ã€‚", "ä½ è®“ç›¸ä¿¡ï¼Œå–œæ­¡ä¸€å€‹äººå¯ä»¥å¾ˆå®‰å¿ƒã€‚", "æˆ‘å–œæ­¡ä½ èµ°è·¯çš„æ¨£å­ï¼Œåƒæ…¢æ…¢èµ°é€²æˆ‘å¿ƒè£¡ã€‚", "ä½ åœ¨ï¼Œæˆ‘å°±ä¸æ€¥è‘—å»å“ªã€‚", "å¦‚æœä¸€å¤©åªèƒ½é¸ä¸€ä»¶é–‹å¿ƒçš„äº‹ï¼Œé‚£ä¸€å®šæ˜¯ä½ ã€‚", "ä½ å‡ºç¾åœ¨æˆ‘ç”Ÿæ´»è£¡ï¼Œæœ¬èº«å°±æ˜¯ç¦®ç‰©ã€‚", "æˆ‘å–œæ­¡ä½ ï¼Œæ˜¯é‚£ç¨®ä¸éœ€è¦è­‰æ˜çš„å–œæ­¡ã€‚", "ä½ ä¸åœ¨èº«é‚Šçš„æ™‚å€™ï¼Œæˆ‘ä¹Ÿåœ¨ç‚ºä½ é ç•™ä½ç½®ã€‚", "æˆ‘æƒ³é™ªä½ çœ‹å¾ˆå¤šæ¬¡æ—¥è½ï¼Œä¸ç”¨èªªè©±é‚£ç¨®ã€‚", "ä½ ä¸€é è¿‘ï¼Œæˆ‘å°±æƒ³æŠŠè²éŸ³æ”¾è¼•ã€‚", "æˆ‘ä¸æ˜¯ä¾è³´ä½ ï¼Œæˆ‘æ˜¯é¸æ“‡ä½ ã€‚", "ä½ è®“ã€Œæœªä¾†ã€é€™å€‹è©ï¼Œè®Šå¾—ä¸é‚£éº¼é™é ã€‚", "æˆ‘å–œæ­¡ä½ çš„å°ç¿’æ…£ï¼Œå‹éä»»ä½•é©šå–œã€‚", "ä½ ä¸ç”¨æ‡‚æˆ‘å…¨éƒ¨ï¼Œæˆ‘æœƒæ…¢æ…¢å‘Šè¨´ä½ ã€‚", "æœ‰ä½ åœ¨ï¼Œé€£ç­‰å¾…éƒ½è®Šå¾—å€¼å¾—ã€‚", "æˆ‘å–œæ­¡ä½ èªçœŸç”Ÿæ´»çš„æ¨£å­ï¼Œä¹Ÿå–œæ­¡ä½ å·æ‡¶çš„æ™‚å€™ã€‚", "ä½ ä¸€å‡ºç¾ï¼Œæˆ‘å°±å¿˜äº†åŸæœ¬åœ¨ç…©ä»€éº¼ã€‚", "æˆ‘æƒ³å’Œä½ ï¼ŒæŠŠæ—¥å­éæˆå½¼æ­¤çš„é å²¸ã€‚", "ä½ ä¸æ˜¯æˆ‘çš„å…¨éƒ¨ï¼Œä½†ä½ è®“ä¸€åˆ‡è®Šå®Œæ•´ã€‚", "æˆ‘é¡˜æ„ç‚ºä½ ï¼ŒæŠŠæ­¥èª¿æ”¾æ…¢ä¸€é»ã€‚", "ä½ ç¬‘çš„æ™‚å€™ï¼Œæˆ‘å¿ƒè£¡æœƒäº®ä¸€ä¸‹ã€‚", "æˆ‘å–œæ­¡ä½ å«æˆ‘åå­—çš„è²éŸ³ã€‚", "ä½ ä¸éœ€è¦ç‰¹åˆ¥åŠªåŠ›ï¼Œæˆ‘æœ¬ä¾†å°±ç«™åœ¨ä½ é€™é‚Šã€‚", "æˆ‘æƒ³ç•¶ä½ å›é ­æ™‚ï¼Œæ°¸é éƒ½åœ¨çš„é‚£å€‹äººã€‚", "å¦‚æœæ„›æœ‰å½¢ç‹€ï¼Œé‚£ä¸€å®šå¾ˆåƒä½ ã€‚", "ä½ è®“æˆ‘å­¸æœƒï¼Œæº«æŸ”ä¹Ÿæ˜¯ä¸€ç¨®åŠ›é‡ã€‚", "æˆ‘å–œæ­¡ä½ é è¿‘æ™‚ï¼Œç©ºæ°£è®Šæš–çš„æ„Ÿè¦ºã€‚", "ä½ åœ¨ï¼Œæˆ‘å°±ä¸æ€•ä¸–ç•Œå¤ªå¤§ã€‚", "æˆ‘æƒ³é™ªä½ ï¼Œèµ°éé‚£äº›ä¸ç¢ºå®šçš„æ—¥å­ã€‚", "ä½ ä¸ç”¨å•æˆ‘åœ¨ä¸åœ¨ï¼Œæˆ‘ä¸€ç›´éƒ½åœ¨ã€‚", "ä½ æ˜¯æˆ‘æ¯å¤©éƒ½æƒ³ç¢ºèªçš„é‚£å€‹å­˜åœ¨ã€‚", "æˆ‘å–œæ­¡ä½ è‡ªç„¶é éä¾†çš„æ¨£å­ã€‚", "ä½ è®“ã€Œå–œæ­¡ã€è®Šå¾—å¾ˆå®‰éœï¼Œä¹Ÿå¾ˆæ·±ã€‚", "æˆ‘é¡˜æ„æŠŠå¥½å¿ƒæƒ…ï¼Œåˆ†ä¸€åŠçµ¦ä½ ã€‚", "ä½ ä¸å¿…é–ƒé–ƒç™¼å…‰ï¼Œä½ ç…§äº®æˆ‘å°±å¤ äº†ã€‚", "æˆ‘å–œæ­¡å’Œä½ ä¸€èµ·ï¼Œä»€éº¼éƒ½ä¸åšã€‚", "ä½ ä¸€å‡ºç¾ï¼Œæ™‚é–“å°±ä¸å†é‚£éº¼åŒ†å¿™ã€‚", "æˆ‘æƒ³æˆç‚ºä½ ç”Ÿæ´»è£¡ï¼Œå¾ˆè‡ªç„¶çš„ä¸€éƒ¨åˆ†ã€‚", "ä½ ä¸ç”¨æ“”å¿ƒæœªä¾†ï¼Œæˆ‘æœƒé™ªä½ æƒ³ã€‚", "æˆ‘å–œæ­¡ä½ å¶çˆ¾çš„å°è¿·ç³Šã€‚", "æœ‰ä½ åœ¨ï¼Œæ—¥å­å°±ä¸æœƒå¤ªè–„ã€‚", "ä½ è®“æˆ‘é–‹å§‹æœŸå¾…æ˜å¤©ã€‚", "æˆ‘æƒ³æŠŠæº«æŸ”ï¼Œè®Šæˆä½ ç¿’ä»¥ç‚ºå¸¸çš„äº‹ã€‚", "ä½ é è‘—æˆ‘çš„æ™‚å€™ï¼Œæˆ‘è¦ºå¾—è‡ªå·±å¾ˆè¢«éœ€è¦ã€‚", "æˆ‘å–œæ­¡ä½ å°æˆ‘æ”¾å¿ƒçš„æ¨£å­ã€‚", "ä½ ä¸ç”¨å¤šèªªï¼Œæˆ‘æ‡‚ä½ çš„æ²‰é»˜ã€‚", "æˆ‘æƒ³è·Ÿä½ ä¸€èµ·ï¼ŒæŠŠæ—¥å¸¸éæˆæµªæ¼«ã€‚", "ä½ ä¸€å‡ºç¾ï¼Œæˆ‘å°±ä¸æƒ³å‡è£å …å¼·ã€‚", "æˆ‘å–œæ­¡ä½ é è¿‘æ™‚ï¼Œé‚£ç¨®å‰›å‰›å¥½çš„è·é›¢ã€‚", "æœ‰ä½ åœ¨ï¼Œä¸–ç•Œå°±ä¸æœƒå¤ªå†·ã€‚", "æˆ‘é¡˜æ„é™ªä½ ï¼Œæ…¢æ…¢è®Šè€ã€‚", "ä½ ä¸æ˜¯é¸é …ï¼Œä½ æ˜¯ç­”æ¡ˆã€‚", "æˆ‘å–œæ­¡ä½ çœ¼è£¡çš„æº«æŸ”ã€‚", "ä½ è®“æˆ‘æ‡‚å¾—ï¼Œå–œæ­¡ä¸ä¸€å®šè¦è½Ÿè½Ÿçƒˆçƒˆã€‚", "æˆ‘æƒ³ç•¶ä½ æœ€å®‰å¿ƒçš„èƒŒæ™¯ã€‚", "ä½ ä¸ç”¨æ’å¾—é‚£éº¼ç”¨åŠ›ï¼Œæˆ‘åœ¨ã€‚", "æˆ‘å–œæ­¡ä½ ç¬‘èµ·ä¾†ï¼Œä¸–ç•Œè·Ÿè‘—äº®ã€‚", "ä½ åœ¨çš„åœ°æ–¹ï¼Œå°±æ˜¯æˆ‘æƒ³å›å»çš„åœ°æ–¹ã€‚", "æˆ‘é¡˜æ„è½ä½ èªªæ‰€æœ‰å°äº‹ã€‚", "ä½ ä¸ç”¨å®Œç¾ï¼Œæˆ‘ä¹Ÿä¸æ˜¯ã€‚", "æˆ‘å–œæ­¡ä½ é¡˜æ„ä¾é æˆ‘çš„æ™‚å€™ã€‚", "æœ‰ä½ åœ¨ï¼Œé€£é›¨å¤©éƒ½ä¸è¨å­äº†ã€‚", "æˆ‘æƒ³å’Œä½ ï¼ŒæŠŠå¹³æ·¡éæˆæº«æŸ”ã€‚", "ä½ ä¸€å›é ­ï¼Œæˆ‘å°±çŸ¥é“è‡ªå·±æ²’èµ°éŒ¯æ–¹å‘ã€‚", "ä½ æ˜¯æˆ‘ç”Ÿæ´»è£¡ï¼Œæœ€å‰›å¥½çš„å­˜åœ¨ã€‚", "æˆ‘æƒ³é™ªä½ ï¼ŒæŠŠæ™‚é–“ç”¨åœ¨å½¼æ­¤èº«ä¸Šã€‚", "ä½ ä¸ç”¨é€å¼·ï¼Œæˆ‘å–œæ­¡ä½ æ”¾é¬†çš„æ¨£å­ã€‚", "æœ‰ä½ åœ¨ï¼Œæˆ‘ä¸æ€•æ…¢ã€‚", "æˆ‘æƒ³æˆç‚ºä½ æ¯å¤©éƒ½æƒ³è¦‹çš„äººã€‚", "ä½ ä¸€å‡ºç¾ï¼Œæˆ‘å°±ä¸æƒ³åˆ†å¿ƒã€‚", "æˆ‘å–œæ­¡ä½ è‡ªç„¶ç‰½éä¾†çš„æ‰‹ã€‚", "ä½ è®“ã€Œå›å®¶ã€è®Šå¾—æœ‰æ„ç¾©ã€‚", "æˆ‘é¡˜æ„ç‚ºä½ ï¼Œç•™ä½æº«æŸ”ã€‚", "æœ‰ä½ åœ¨ï¼Œå¿ƒå°±ä¸æ¼‚æ³Šã€‚"];
        const quotesNaughty = ["å°å¦³çš„æ„›ï¼Œä¸åªæ˜¯èªªèªªè€Œå·²ï¼Œå› ç‚ºå‰©ä¸‹çš„æƒ³ç”¨è¡Œå‹•æ…¢æ…¢ä¾†ã€‚", "æˆ‘å°ä½ å¾ˆæ­£ç¶“ï¼Œæ­£ç¶“åˆ°ä¸å¤ªæƒ³æ”¾éä½ ã€‚", "ä½ ä¸€é è¿‘ï¼Œæˆ‘çš„ç†æ™ºå°±é–‹å§‹ä¸‹ç­ã€‚", "æˆ‘æƒ³ç•¶å€‹ç´³å£«ï¼Œä½†ä½ ä¸€çœ‹æˆ‘ï¼Œæˆ‘å°±æƒ³çŠ¯è¦ã€‚", "ä½ ä¸ç”¨æ’©ï¼Œæˆ‘è‡ªå·±æœƒäº‚æƒ³ã€‚", "æˆ‘å–œæ­¡ä½ çœ‹è‘—æˆ‘ï¼Œåˆå‡è£ä»€éº¼éƒ½æ²’æƒ³çš„æ¨£å­ã€‚", "æˆ‘ä¸æ˜¯å£ï¼Œæˆ‘åªæ˜¯å°ä½ æ²’ä»€éº¼æŠµæŠ—åŠ›ã€‚", "ä½ ä¸€ç¬‘ï¼Œæˆ‘å°±çŸ¥é“ä»Šæ™šæœƒä¸å¥½ç¡ã€‚", "æˆ‘å¾ˆæ­£ç¶“åœ°å–œæ­¡ä½ ï¼Œä¸æ­£ç¶“çš„æ˜¯å¾Œé¢é‚£äº›å¿µé ­ã€‚", "ä½ é éä¾†çš„æ™‚å€™ï¼Œæˆ‘é€£å‘¼å¸éƒ½ä¸å¤ªå–®ç´”ã€‚", "æˆ‘æƒ³æŠ±ä½ ï¼Œæ˜¯é‚£ç¨®ä¸å¤ªæƒ³æ”¾æ‰‹çš„ã€‚", "ä½ ä¸€é è¿‘ï¼Œæˆ‘å°±é–‹å§‹å£æ˜¯å¿ƒéã€‚", "æˆ‘ä¸æ˜¯æƒ³æ’©ä½ ï¼Œæˆ‘æ˜¯æƒ³è¦ä½ ã€‚", "ä½ ä¸ç”¨èªªè©±ï¼Œæˆ‘å°±çŸ¥é“ä½ åœ¨æƒ³ä»€éº¼ã€‚", "æˆ‘å¾ˆä¹–ï¼Œåªå°ä½ ä¸å¤ªä¹–ã€‚", "ä½ é€™æ¨£çœ‹æˆ‘ï¼Œæˆ‘å¾ˆé›£ç•¶å¥½äººã€‚", "æˆ‘å–œæ­¡ä½ é å¾—å¾ˆè¿‘ï¼Œè¿‘åˆ°æˆ‘æ²’è¾¦æ³•è£å†·éœã€‚", "ä½ ä¸€çšºçœ‰ï¼Œæˆ‘å°±æƒ³å“„ï¼›ä½ ä¸€é è¿‘ï¼Œæˆ‘å°±æƒ³æ›´å£ä¸€é»ã€‚", "æˆ‘æƒ³æŠŠä½ æŠ±ç·Šï¼Œåç¾©ä¸Šå«ä¿è­·ã€‚", "ä½ å°æˆ‘ä¾†èªªï¼Œæ˜¯é‚£ç¨®ä¸èƒ½å¤ªé è¿‘çš„å±éšªã€‚", "æˆ‘å°ä½ æ²’æœ‰é‡å¿ƒï¼Œåªæœ‰ä½”æœ‰æ…¾ã€‚", "ä½ ä¸€æ’’å¬Œï¼Œæˆ‘æ‰€æœ‰åŸå‰‡éƒ½è‡ªå‹•å–æ¶ˆã€‚", "æˆ‘ä¸æ˜¯æ•…æ„é é‚£éº¼è¿‘ï¼Œæ˜¯ä½ å¤ªå¥½æŠ±ã€‚", "ä½ ä¸ç”¨è©¦æ¢ï¼Œæˆ‘æœ¬ä¾†å°±å¾ˆæƒ³ã€‚", "æˆ‘æƒ³å°ä½ æº«æŸ”ï¼Œä¹Ÿæƒ³å°ä½ å¤±æ§ã€‚", "ä½ ä¸€é è¿‘ï¼Œæˆ‘å°±æƒ³æŠŠä¸–ç•ŒéœéŸ³ã€‚", "æˆ‘å–œæ­¡ä½ é‚£ç¨®ï¼Œæ˜æ˜çŸ¥é“å»ä¸èªªç ´çš„çœ¼ç¥ã€‚", "æˆ‘ä¸å¤ªæœƒæ’©äººï¼Œæˆ‘åªæœƒä¸€ç›´æƒ³ä½ ã€‚", "ä½ åœ¨æˆ‘æ‡·è£¡çš„æ™‚å€™ï¼Œæˆ‘æœ€ä¸åƒå€‹å¥½äººã€‚", "æˆ‘å–œæ­¡ä½ å°æˆ‘æ¯«ç„¡é˜²å‚™çš„æ¨£å­ã€‚", "æˆ‘æƒ³é è¿‘ä½ ï¼Œä¸åªæ˜¯ä¸€ä¸‹ã€‚", "ä½ ä¸€çœ‹æˆ‘ï¼Œæˆ‘å°±çŸ¥é“è‡ªå·±å®Œäº†ã€‚", "æˆ‘å°ä½ æ˜¯é‚£ç¨®ï¼Œæ…¢æ…¢ä¾†ä½†ä¸æ‰“ç®—åœçš„ã€‚", "ä½ ä¸ç”¨å‹•ï¼Œæˆ‘è‡ªå·±æœƒéå»ã€‚", "æˆ‘æƒ³æŠ±ä½ ä¹…ä¸€é»ï¼Œç†ç”±ä¹‹å¾Œå†èªªã€‚", "ä½ é€™æ¨£é è‘—ï¼Œæˆ‘æœƒæƒ³å¾ˆå¤šä¸è©²æƒ³çš„äº‹ã€‚", "æˆ‘å°ä½ ï¼Œä¸€å‘ä¸å¤ªå®ˆè¦çŸ©ã€‚", "ä½ ä¸ç”¨æé†’æˆ‘ï¼Œæˆ‘çŸ¥é“æˆ‘åœ¨æ’©ã€‚", "æˆ‘å¾ˆæº«æŸ”ï¼Œä½†åªå°ä½ å¤±æ§ã€‚", "ä½ ä¸€é è¿‘ï¼Œæˆ‘å°±å¿˜äº†ä»€éº¼å«ç•Œç·šã€‚", "æˆ‘ä¸æ˜¯æƒ³ä½”ä½ ä¾¿å®œï¼Œæˆ‘æ˜¯æƒ³ä½”ä½ ã€‚", "ä½ ä¸€ç¬‘ï¼Œæˆ‘å°±æƒ³æŠŠä½ å¸¶èµ°ã€‚", "ç²¾é€šå¢¨è‰²ä¹‹å¾Œï¼Œæˆ‘æ›´æƒ³æŸ“ç´…ä½ çš„å”‡ã€‚", "ä½ é éä¾†çš„æ™‚å€™ï¼Œæˆ‘ä¸å¤ªæƒ³ç•¶å›å­ã€‚", "æˆ‘æƒ³è®“ä½ ç¿’æ…£æˆ‘ï¼Œç¿’æ…£åˆ°é›¢ä¸é–‹é‚£ç¨®ã€‚", "ä½ ä¸ç”¨èº²ï¼Œæˆ‘æ—©å°±çœ‹ä¸Šä½ äº†ã€‚", "æˆ‘å–œæ­¡ä½ çœ‹æˆ‘æ™‚ï¼Œé‚£ç¨®å¿ƒçŸ¥è‚šæ˜ã€‚", "æˆ‘ä¸æ˜¯æƒ³æ’©ä½ ï¼Œæˆ‘æ˜¯èªçœŸæƒ³è¦ä½ ã€‚", "ä½ é€™æ¨£çœ‹æˆ‘ï¼Œæˆ‘å¾ˆé›£ä¸é éå»ã€‚", "æˆ‘å°ä½ ï¼Œå‘ä¾†æ²’ä»€éº¼è‡ªåˆ¶åŠ›ã€‚"];

        let appState = {
            name1: "æˆ‘å€‘", name2: "å½¼æ­¤", startDate: "", symbol: "ğŸŒ¸",
            isNaughtyMode: false, events: []
        };

        function saveState() { localStorage.setItem('loveFusion_v5', JSON.stringify(appState)); }
        function loadState() {
            const saved = localStorage.getItem('loveFusion_v5');
            if (saved) appState = JSON.parse(saved);
        }

        function updateUI() {
            const hasDate = appState.startDate !== "";
            document.getElementById('main-view').style.display = hasDate ? 'block' : 'none';
            document.getElementById('setup-view').style.display = hasDate ? 'none' : 'block';
            if (hasDate) {
                document.getElementById('display-names').innerText = `${appState.name1} & ${appState.name2}`;
                document.getElementById('display-symbol').innerText = appState.symbol;
                const start = new Date(appState.startDate);
                const now = new Date();
                start.setHours(0,0,0,0); now.setHours(0,0,0,0);
                const diffDays = Math.floor((now - start) / (1000*60*60*24));
                document.getElementById('days-count').innerText = diffDays >= 0 ? diffDays : 0;
                const years = Math.floor(diffDays / 365);
                const months = Math.floor(diffDays / 30);
                let prefix = (diffDays < 30) ? `æ­¥éäº† ${diffDays} å€‹æ¸…æ™¨èˆ‡é»ƒæ˜` : (diffDays < 365) ? `åŒè³äº† ${months} æ¬¡æ»¿æœˆç›ˆè™§` : `å…±èµ´äº† ${years} åº¦æ˜¥ç§‹ï¼Œæ·±æƒ…ä¾èˆŠ`;
                document.getElementById('sweet-prefix-text').innerText = prefix;
                document.getElementById('next-event-card').style.display = 'block';
                updateNextEvent();
            }
        }

        window.handleMainCardClick = function() {
            if (appState.startDate === "") openSettings(); else refreshQuote();
        };

        window.handleSettingsClick = function(e) { e.stopPropagation(); openSettings(); };

        function refreshQuote() {
            const list = appState.isNaughtyMode ? quotesNaughty : quotesSweet;
            const modeName = appState.isNaughtyMode ? "å¾®é†ºæ¨¡å¼" : "èŠ±è¦‹æ¨¡å¼";
            const idx = Math.floor(Math.random() * list.length);
            const qText = document.getElementById('quote-text');
            qText.style.opacity = 0;
            setTimeout(() => {
                qText.innerText = list[idx];
                document.getElementById('quote-tag').innerText = `${modeName} #${idx + 1}`;
                qText.style.opacity = 1;
            }, 200);
        }

        function updateNextEvent() {
            const now = new Date(); now.setHours(0,0,0,0);
            let all = [...appState.events];
            if(appState.startDate) all.push({ name: "åœ¨ä¸€èµ·é€±å¹´ç´€å¿µ", date: appState.startDate });
            let minDiff = Infinity, target = null, targetDate = null;
            all.forEach(e => {
                const d = new Date(e.date);
                let next = new Date(now.getFullYear(), d.getMonth(), d.getDate());
                if (next < now) next = new Date(now.getFullYear() + 1, d.getMonth(), d.getDate());
                const diff = Math.ceil((next - now) / (1000*60*60*24));
                if (diff < minDiff) { minDiff = diff; target = e; targetDate = next; }
            });
            if (target) {
                document.getElementById('next-event-name').innerText = target.name;
                document.getElementById('next-event-days').innerText = minDiff;
                document.getElementById('next-event-date').innerText = `${targetDate.getMonth()+1}æœˆ${targetDate.getDate()}æ—¥`;
            }
        }

        window.openSettings = function() {
            document.getElementById('input-name1').value = appState.name1;
            document.getElementById('input-name2').value = appState.name2;
            document.getElementById('input-start-date').value = appState.startDate;
            document.getElementById('input-symbol').value = appState.symbol;
            document.getElementById('input-naughty-mode').checked = appState.isNaughtyMode;
            syncModeText();
            document.getElementById('settings-modal').style.display = 'block';
        };

        window.saveSettings = function() {
            appState.name1 = document.getElementById('input-name1').value || "A";
            appState.name2 = document.getElementById('input-name2').value || "B";
            appState.startDate = document.getElementById('input-start-date').value;
            appState.symbol = document.getElementById('input-symbol').value;
            appState.isNaughtyMode = document.getElementById('input-naughty-mode').checked;
            saveState(); updateUI(); refreshQuote(); closeModal('settings-modal');
        };

        window.openEventList = function() { renderEventList(); document.getElementById('event-list-modal').style.display = 'block'; };
        window.addEvent = function() {
            const n = document.getElementById('new-event-name').value;
            const d = document.getElementById('new-event-date').value;
            if (n && d) { appState.events.push({ name: n, date: d }); saveState(); renderEventList(); updateNextEvent();
                document.getElementById('new-event-name').value = ''; document.getElementById('new-event-date').value = ''; }
        };
        window.deleteEvent = function(idx) { appState.events.splice(idx, 1); saveState(); renderEventList(); updateNextEvent(); };
        function renderEventList() {
            const container = document.getElementById('events-container'); container.innerHTML = '';
            appState.events.forEach((e, idx) => {
                const div = document.createElement('div'); div.className = 'event-item';
                div.innerHTML = `<span>${e.name} (${e.date.slice(5)})</span><span style="color:#ccc;cursor:pointer" onclick="deleteEvent(${idx})">âœ–</span>`;
                container.appendChild(div);
            });
        }
        window.closeModal = function(id) { document.getElementById(id).style.display = 'none'; };
        window.syncModeText = function() {
            const isN = document.getElementById('input-naughty-mode').checked;
            document.getElementById('setting-mode-icon').innerText = isN ? "ğŸŒ™" : "ğŸŒ¸";
            document.getElementById('setting-mode-text').innerText = isN ? "å¾®é†ºæ¨¡å¼" : "èŠ±è¦‹æ¨¡å¼";
        };

        const canvas = document.getElementById('canvas-bg');
        const ctx = canvas.getContext('2d');
        let flowers = [];
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();
        class Flower {
            constructor() { this.reset(); }
            reset() {
                this.x = Math.random() * canvas.width; this.y = Math.random() * canvas.height;
                this.size = Math.random() * 12 + 6; this.alpha = 0; this.maxA = Math.random() * 0.3 + 0.1;
                this.life = 0; this.color = Math.random() > 0.7 ? '#f8c6d1' : '#eeeeee';
            }
            draw() {
                ctx.save(); ctx.translate(this.x, this.y); ctx.globalAlpha = this.alpha; ctx.fillStyle = this.color;
                for (let i = 0; i < 5; i++) { ctx.rotate((Math.PI * 2) / 5); ctx.beginPath();
                    ctx.ellipse(this.size, 0, this.size, this.size/2, 0, 0, Math.PI * 2); ctx.fill(); }
                ctx.restore();
                if (this.life < 150) this.alpha = Math.min(this.maxA, this.alpha + 0.003); else this.alpha -= 0.002;
                this.life++; if (this.alpha <= 0) this.reset();
            }
        }
        function initFlowers() { for(let i=0; i<18; i++) flowers.push(new Flower()); }
        function animate() { ctx.clearRect(0,0,canvas.width, canvas.height); flowers.forEach(f => f.draw()); requestAnimationFrame(animate); }
        window.onload = () => { loadState(); updateUI(); refreshQuote(); initFlowers(); animate(); };
    </script>
</body>
</html>
